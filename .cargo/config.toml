[build]
jobs = 8

[alias]
pro = "build --profile pro"

pro-native = [
  "build",
  "--profile",
  "pro",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=native\"]",
]

pro-linux-v1 = [
  "build",
  "--profile",
  "pro-linux-v1",
  "--config",
  "env.COSMOSTRIX_BUILD=\"linux-x86_64-v1\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=x86-64\"]",
  "--target",
  "x86_64-unknown-linux-gnu",
]
pro-linux-v2 = [
  "build",
  "--profile",
  "pro-linux-v2",
  "--config",
  "env.COSMOSTRIX_BUILD=\"linux-x86_64-v2\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=x86-64-v2\"]",
  "--target",
  "x86_64-unknown-linux-gnu",
]
pro-linux-v3 = [
  "build",
  "--profile",
  "pro-linux-v3",
  "--config",
  "env.COSMOSTRIX_BUILD=\"linux-x86_64-v3\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=x86-64-v3\"]",
  "--target",
  "x86_64-unknown-linux-gnu",
]
pro-linux-v4 = [
  "build",
  "--profile",
  "pro-linux-v4",
  "--config",
  "env.COSMOSTRIX_BUILD=\"linux-x86_64-v4\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=x86-64-v4\"]",
  "--target",
  "x86_64-unknown-linux-gnu",
]

pro-macos-aarch64-native = [
  "build",
  "--profile",
  "pro-macos-aarch64-native",
  "--target",
  "aarch64-apple-darwin",
  "--config",
  "env.COSMOSTRIX_BUILD=\"darwin-aarch64-native\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=native\"]",
]

pro-win-x86_64 = [
  "build",
  "--profile",
  "pro-win-x86_64",
  "--target",
  "x86_64-pc-windows-msvc",
  "--config",
  "env.COSMOSTRIX_BUILD=\"windows-x86_64\"",
  "--config",
  "build.rustflags=[\"-C\",\"target-cpu=x86-64\"]",
]

pro-android-aarch64 = """!bash -lc 'set -euo pipefail; : "${ANDROID_NDK_HOME:?ANDROID_NDK_HOME is required}"; TARGET="aarch64-linux-android"; TOOLCHAIN="${ANDROID_NDK_HOME}/toolchains/llvm/prebuilt/linux-x86_64"; export CC_aarch64_linux_android="${TOOLCHAIN}/bin/aarch64-linux-android21-clang"; export CARGO_TARGET_AARCH64_LINUX_ANDROID_LINKER="${CC_aarch64_linux_android}"; COSMOSTRIX_BUILD="android-aarch64-native" cargo build --profile pro-android-aarch64 --target "${TARGET}"'"""
